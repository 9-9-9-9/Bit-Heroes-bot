<html>

<head>
	<meta charset="utf-8">
	<title>Command-line builder</title>
	<meta name="title" content="99bot command-line builder">
	<meta name="description" content="Command-line builder in order to run command line">
	<meta name="robots" content="index, follow" />
	<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
	<meta http-equiv=”Content-Type” content=”text/html; charset=utf-8″ />
	<meta property="og:url" content="http://bh99bot.com" />
	<meta property="og:type" content="website" />
	<meta property="og:title" content="99bot command-line builder" />
	<meta property="og:description" content="Command-line builder in order to run command line" />
	<meta property="og:image" content="./img/gcp.png" />
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"
		integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	<link rel="stylesheet" type="text/css" href="style.css">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
	<style>
		span.trigger-prepare {
			cursor: pointer;
			color: blue;
			padding: 20px;
			font-size: 2rem;
		}

		div#builder {
			padding: 30px;
		}

		.hidden {
			display: none;
		}

		#build {
			cursor: pointer;
		}
	</style>
	<script type="text/javascript">
		var meta = {};
		var selectedApp = {};
		var validFlags = [];

		$(document).ready(function () {
			$.getJSON("http://bh99bot.com/json/meta.json", function (data) {
				meta = data;

				for (let i = 0; i < meta.apps.length; i++) {
					const app = meta.apps[i];
					$('ul.nav').append('<span class="trigger-prepare" onclick="prepare(\'' + app.code + '\')">' + app.name + '</span>');
				}
			});
		});

		var findApp = (appCode) => {
			for (let i = 0; i < meta.apps.length; i++) {
				const app = meta.apps[i];
				if (app.code === appCode) {
					return app;
				}
			}

			return undefined;
		};

		var getFlagInfos = (app) => {
			let flags = app.flags;

			const result = [];
			for (let i = 0; i < meta.flags.length; i++) {
				const flag = meta.flags[i];
				if (flags.includes(flag.code)) {
					result.push(flag);
				}
			}

			return result;
		};

		var prepare = (appCode) => {
			$('#command').val('');

			const app = findApp(appCode);
			selectedApp = app;

			$('#arg').val(app.argDefault);

			if (!isBlank(selectedApp.argHint))
				$('#arg-hint').text(app.argHint);
			else
				$('#arg-hint').text('');

			$('div#builder > h2#name').text(selectedApp.name);
			$('div#builder > h5#code > i > span').text(selectedApp.code);

			if (!isBlank(selectedApp.argAsk)) {
				if (selectedApp.argRequired !== true) {
					$('#notice-arg').addClass("hidden");
				} else {
					$('#notice-arg').removeClass("hidden");
				}
				$('#ask-arg').text(selectedApp.argAsk);
			} else {
				$('#notice-arg').addClass("hidden");
				$('#ask-arg').text('');
			}

			validFlags = getFlagInfos(app);

			$('div#builder').removeClass('hidden');
		};

		var buildCommand = () => {
			$('#command').val('');
			
			const arg = $('#arg').val();

			if (selectedApp.argRequired && isBlank(arg)) {
				alert('Argument is required');
				return;
			}

			$('#command').val('java -jar BitHeroes.jar ' + selectedApp.code + (isBlank(arg) ? "" : (" " + arg)));
		};

		const isBlank = (text) => {
			return text === undefined || text === null || text.length == 0;
		}
	</script>
</head>

<body>
	<ul class="nav">
	</ul>
	<div id="builder" class="hidden">
		<hr />
		<h2 id="name"></h2>
		<h5 id="code" class="text-secondary"><i>Function code: <span></span></i></h5>
		<hr />
		<p id="notice-arg" class="text-secondary hidden"><i>Parameter is required</i></p>
		<p id="ask-arg"></p>
		<input id="arg">
		<p id="arg-hint" class="text-secondary"></p>
		<hr />
		<p class="btn btn-primary" id="build" onclick="buildCommand()">Build command-line</p>
		<br />
		<input id="command" disabled="true">
	</div>
</body>

</html>